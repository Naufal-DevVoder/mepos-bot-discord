const Discord = require("discord.js");
const client = new Discord.Client();
client.login(process.env.Token);
const config = require("./config.json");
const { prefix, Token } = require("./config.json");
client.login(Token);
client.on("message", async message => {
  console.log("‚ùØ Rejs senpai " + client.user.username + " is now online!");
  console.log("‚ùØ Gateway ping : " + client.ws.ping + "ms");
  console.log(message.author.username + " menggunakan bot Saekyo");
  const args = message.content
    .slice(prefix.length)
    .trim()
    .split(/ +/g);
  const command = args.shift().toLowerCase();

  // COMMAND CLEAR
  let messageArray = message.content.split(" ");
  let cmd = messageArray[0];
  
  //Status Bot
  let status = [
    "My code",
    "/help",
    "With Rejs senpai >_<",
    "Stay safe"
  ];
  setInterval(() => {
    let index = Math.floor(Math.random() * (status.length - 1) + 1);
    client.user.setActivity(" | " + status[index]);
  }, 8000);
  client.user.setStatus("online");

  //command say
  if (command === "say") {
    let text = args.join(" ");
    if (!text) return message.reply("Please give me some text to say! :)");
    message.delete();
    message.channel.send(text);
  }

  // HELP COMMAND
  else if (message.content === prefix + "help") {
    message.channel.send("Mohon maaf bot Saekyo sedang dalam perbaikan :)");
    message.delete();
  }

  //ping command
  else if (message.content === prefix + "ping") {
    message.channel.send("üèì Pong! `" + client.ws.ping + "ms`");
    message.delete({ timeout: 4000 }); //angkanya bebas
  }

  // MORE COMMAND
  else if (message.content === "<@725432896533299200>") {
    message.channel.send("Iya apa " + message.author.toString() + " >////<");
  } else if (message.content.startsWith("poke")) {
    let userToMention = message.mentions.users.first();
    message.channel.send("Mention: " + userToMention.toString());
  } else if (message.content === "Hai") {
    message.channel.send("Hai juga " + message.author.toString() + " >_<");
  } else if (message.content === "hai") {
    message.channel.send("Hai juga " + message.author.toString() + " >_<");
  } else if (message.content === "Hi") {
    message.channel.send("Hai juga " + message.author.toString() + " >_<");
  } else if (message.content === "hi") {
    message.channel.send("Hai juga " + message.author.toString() + " >_<");
  } else if (message.content === "Halo") {
    message.channel.send("Halo juga " + message.author.toString() + " >_<");
  } else if (message.content === "halo") {
    message.channel.send("Halo juga " + message.author.toString() + " >_<");
  } else if (message.content === prefix + "beep") {
    message.channel.send("!boop");
  } else if (message.content === "tes") {
    message.channel.send("Tos!");
  } else if (message.content === "Tes") {
    message.channel.send("Tos!");
  }

  //Kill Command
  else if (message.content.startsWith(`${prefix}kill`)) {
    let user = message.mentions.users.first();
    if (!user) {
      return message.channel.send("Please include who you are killing.");
    }
    message.delete();
    return message.channel.send(
      message.author.username + " Killed " + user.username
    );
  }

  //USER INFO
  else if (message.content === prefix + "user-info") {
    const RichEmbed = new Discord.MessageEmbed()
      .setColor("RANDOM")
      .setAuthor(
        message.author.tag,
        message.author.displayAvatarURL({ format: "png", dynamic: true })
      )
      .setThumbnail(
        message.author.displayAvatarURL({ format: "png", dynamic: true })
      )
      .addField("‚ùØ Bot", message.author.bot ? "True" : "False", true)
      .addField(
        "‚ùØ Status",
        "```" + message.author.presence.status + "```",
        true
      )
      .addField("‚ùØ Join", "```" + message.member.joinedAt + "```")
      .addField("‚ùØ Register", "```" + message.author.createdAt + "```")
      .addField(
        "‚ùØ Roles",
        message.member.roles.cache.map(r => `${r}`).join(" , ")
      )
      .setTimestamp()
      .setFooter("Id : " + message.author.id);
    message.channel.send(RichEmbed);
    message.delete({ timeout: 4000 }); //angkanya bebas
  }

  // AVATAR COMMAND
  else if (message.content === prefix + "avatar") {
    const exampleEmbed = new Discord.MessageEmbed()
      .setColor("RANDOM")
      .setTitle("Avatar")
      .setAuthor(
        message.author.tag,
        message.author.displayAvatarURL({ format: "jpg" })
      )
      .setImage(
        message.author.displayAvatarURL({ format: "png", dynamic: true })
      );
    message.channel.send(exampleEmbed);
    message.delete({ timeout: 4000 }); //angkanya bebas
  }

  // BOT INFO COMMAND
  else if (message.content === prefix + "bot-info") {
    const botEmbed = new Discord.MessageEmbed()
      .setColor("RANDOM")
      .setAuthor(
        "Bot Information",
        message.author.displayAvatarURL({ format: "png", dynamic: true })
      )
      .setThumbnail(
        message.author.displayAvatarURL({ format: "png", dynamic: true })
      )
      .setTitle("Donate")
      .setURL("https://saweria.co/donate/Saekyo")
      .addField("‚ùØ Bot ping","```" + client.ws.ping + "ms```")
      .addField("‚ùØ Bot Name", "```Saekyo#1965```")
      .addField("‚ùØ Bot Id", "```725432896533299200```")
      .addField("‚ùØ Created By", "```Rejs#9735```")
      .addField("‚ùØ Created At", "```" + client.user.createdAt + "```")
      .setFooter("¬© Made by rejs#9735")
      .setTimestamp();
    message.channel.send(botEmbed);
    message.delete({ timeout: 4000 }); //angkanya bebas
  }

  // SERVER INFO COMMAND
  else if (message.content === prefix + "server-info") {
    const serverEmbed = new Discord.MessageEmbed()
      .setColor("RANDOM")
      .setTitle("Donate")
      .setURL("https://saweria.co/donate/Saekyo")
      .setAuthor(message.guild.name, message.guild.iconURL({ format: "png" }))
      .setThumbnail(message.guild.iconURL({ format: "png" }))
      .addField("‚ùØ Name", "```" + message.guild.name + "```", true)
      .addField("‚ùØ ID", "```" + message.guild.id + "```", true)
      .addField("‚ùØ Owner", "```" + message.guild.owner.user.tag + "```", true)
      .addField(
        "‚ùØ Region",
        "```" + message.guild.region.toUpperCase() + "```",
        true
      )
      .addField("‚ùØ Members", "```" + message.guild.memberCount + "```", true)
      .addField("‚ùØ Roles", "```" + message.guild.roles.cache.size + "```", true)
      .addField(
        "‚ùØ Channels",
        "```" +
          message.guild.channels.cache.filter(
            channel => channel.type !== "category"
          ).size +
          "```",
        true
      )
      .addField("‚ùØ Creation Date", "```" + message.guild.createdAt + "```")
      .setTimestamp();
    message.channel.send(serverEmbed);
    message.delete({ timeout: 4000 });
  }

  // WARN TOXIC SANGAT PENTING AMJING
  const swearWords = ["Kontol", "kontol", "Nigga", "nigga"];
  if (swearWords.some(word => message.content.includes(word))) {
    message.reply("Oh no you said a bad word!!!");
    message.delete();
  }

  //Clear Command
  else if (cmd === prefix + "clear") {
    let argu = messageArray.slice(1);
    if (message.deletable) {
      message.delete();
    }
    if (!message.member.hasPermission("MANAGE_MESSAGES")) {
      return message.reply("Missing Permission").then(m => m.delete(5000));
    }
    if (isNaN(argu[0]) || parseInt(argu[0]) <= 0) {
      return message.reply("This is not number").then(m => m.delete(5000));
    }
    let deleteAmount;
    if (parseInt(argu[0]) > 100) {
      deleteAmount = 100;
    } else {
      deleteAmount = parseInt(argu[0]);
    }
    message.channel
      .bulkDelete(deleteAmount, true)
      .catch(err => message.reply("something went wrong‚Ä¶" + err));
  }

  //COINFLIP COMMAND  
  else if (message.content.startsWith(prefix + "coinflip")) {
    var choices = ["heads", "tails"];

    var output = choices[Math.floor(Math.random() * choices.length)];

    message.reply(`You got **${output}!**`);
  }

  //TALK COMMAND
  else if (message.content.startsWith(prefix + "talk tes")) {
    var tes = ["tos", "Iya apa sayang", "Apa BGST", "TAI Lu AMJING"];

    var output = tes[Math.floor(Math.random() * tes.length)];

    message.reply(`**${output}!**`);
  }

  // POLL Command
  else if (cmd === "/poll") {
    if (!message.member.hasPermission("MANAGE_MESSAGES")) {
      return message.reply("Missing Permission").then(m => m.delete(5000));
    }
    let pollChannel = message.mentions.channels.first();
    let pollDescription = args.slice(1).join(" ");

    let embedPoll = new Discord.MessageEmbed()
      .setTitle("üò≤ New Poll! üò≤")
      .setDescription(pollDescription)
      .setColor("RANDOM");
    let msgEmbed = await pollChannel.send(embedPoll);
    await msgEmbed.react("üëç");
    await msgEmbed.react("üëé");
    message.delete();
  }

  // MINESWEEPER COMMAND (ep 14)
  else if (message.content.startsWith(`${prefix}mine`)) {
    const Minesweeper = require("discord.js-minesweeper");

    const minesweeper = new Minesweeper({
      returnType: "emoji"
    });
    var mines = minesweeper.start();
    message.channel.send(mines);
  }

  // LYRICS FINDER COMMAND (ep 13)
  else if (message.content.startsWith(`${prefix}lyrics`)) {
    const genius = require("genius-lyrics");
    const G = new genius.Client(process.env.GENIUS);

    G.tracks
      .search(
        message.content
          .split(" ")
          .slice(1)
          .join(" "),
        { limit: 1 }
      )
      .then(results => {
        const song = results[0];
        message.channel.send(
          `**${song.artist.name} - ${song.title}**\n<${song.url}>`
        ); //song.lyrics
      })
      .catch(err => message.reply(err));
  }
  
   //SLOWMODE COMMAND (episode 8)
  else if(message.content.startsWith(`${prefix}slowmode`)) {
    var time = message.content.split(' ').slice(1).join(' ')
    if(!time) return message.reply('Please enter a time in seconds!')
   message.channel.setRateLimitPerUser(time)
     message.channel.send('Set the slowmode!')
  }

  //ANNOUNCEMENT COMMAND
  else if (cmd === "/announce") {
    if (!message.member.hasPermission("MANAGE_MESSAGES")) {
      return message.reply("Missing Permission").then(m => m.delete(5000));
    }
    let announceChannel = message.mentions.channels.first();
    let announceDescription = args.slice(1).join(" ");

    let embedAnnouncement = new Discord.MessageEmbed()
      .setTitle("üò≤ Announcement! üò≤")
      .setDescription(announceDescription)
      .setColor("RANDOM");
    let msgEmbed = await announceChannel.send(embedAnnouncement);
    message.delete();
  }

  // EMOJI COMMAND
  else if (message.content.startsWith(prefix + "emoji")) {
    var emoji = [
      "( Õ°¬∞ Õú ñ Õ°¬∞)",
      "¬Ø\\_(„ÉÑ)_/¬Ø",
      " ï‚Ä¢·¥•‚Ä¢ î",
      "(‚ñÄÃøƒπÃØ‚ñÄÃø Ãø)",
      "(‡∏á Õ†¬∞ ÕüŸÑÕú Õ°¬∞)‡∏á",
      "‡≤†_‡≤†",
      "Ãø'Ãø'\\ÃµÕáÃøÃø\\–∑=( Õ†¬∞ Õü ñ Õ°¬∞)=Œµ/ÃµÕáÃøÃø/'ÃøÃø Ãø Ãø Ãø Ãø Ãø",
      "[Ã≤ÃÖ$Ã≤ÃÖ(Ã≤ÃÖ5Ã≤ÃÖ)Ã≤ÃÖ$Ã≤ÃÖ]",
      "Ô¥æÕ°‡πèÃØÕ°‡πèÔ¥ø O'RLY?",
      "[Ã≤ÃÖ$Ã≤ÃÖ(Ã≤ÃÖ Õ°¬∞ Õú ñ Õ°¬∞Ã≤ÃÖ)Ã≤ÃÖ$Ã≤ÃÖ]",
      "(·µî·¥•·µî)",
      "(¬¨‚Äø¬¨)",
      "(‚òûÔæü„ÉÆÔæü)‚òû ‚òú(Ôæü„ÉÆÔæü‚òú)",
      "(„Å•Ôø£ ¬≥Ôø£)„Å•",
      "·Éö(‡≤†Áõä‡≤†·Éö)",
      "‡≤†‚ï≠‚ïÆ‡≤†",
      "‚ô™~ ·ïï(·êõ)·ïó",
      "„Éæ(‚åê‚ñ†_‚ñ†)„Éé‚ô™",
      "‚óâ_‚óâ",
      "\\ (‚Ä¢‚ó°‚Ä¢) /",
      "‡ºº òÃöŸÑÕú òÃö‡ºΩ",
      "‚î¨‚î¥‚î¨‚î¥‚î§(ÔΩ•_‚îú‚î¨‚î¥‚î¨‚î¥",
      "·ï¶(√≤_√≥Àá)·ï§",
      "‚îª‚îÅ‚îª Ô∏µ„ÉΩ(`–î¬¥)ÔæâÔ∏µ ‚îª‚îÅ‚îª",
      "Ôºà‚ïØ¬∞‚ñ°¬∞Ôºâ‚ïØÔ∏µ( .o.)",
      "‡≤†‚Äø‚Üº",
      "‚óî ‚å£ ‚óî",
      "(„Éé‡≤†Áõä‡≤†)„ÉéÂΩ°‚îª‚îÅ‚îª",
      "(‚òûÔæü„ÉÆÔæü)‚òû ‚òú(Ôæü„ÉÆÔæü‚òú)",
      "Ãø Ãø Ãø'Ãø'ÃµÕáÃøÃø–∑=(‚Ä¢_‚Ä¢)=Œµ/ÃµÕáÃøÃø/'Ãø'Ãø Ãø",
      "(;¬¥‡ºé‡∫∂–î‡ºé‡∫∂`)",
      "‚ô•‚Äø‚ô•",
      "·ï¶(√≤_√≥Àá)·ï§",
      "(‚Ä¢_‚Ä¢) ( ‚Ä¢_‚Ä¢)>‚åê‚ñ†-‚ñ† (‚åê‚ñ†_‚ñ†)",
      "‚åê‚ï¶‚ï¶‚ïê‚îÄ ‡≤†_‡≤† , (¬¨‚Äø¬¨)",
      "Àô‚ÄÜÕú üÀô",
      ":')",
      "(¬∞„É≠¬∞)‚òù",
      "‡≤†‚å£‡≤†",
      "(Ôºõ‰∏Ä_‰∏Ä)",
      "( ‚öÜ _ ‚öÜ )",
      "‚òú(‚åí‚ñΩ‚åí)‚òû",
      "( ò·ó© ò')",
      "¬Ø\\(¬∞_o)/¬Ø",
      "·Éö,·îë‚Ä¢Ô∫™ÕüÕ†‚Ä¢·îê.·Éö",
      "( ò‚Äø ò)",
      "‡≤†~‡≤†",
      "‡≤†_‡≤•",
      "‡≤†‚Äø‚Üº",
      "(>·Éö)",
      "(·É¶Àò‚å£Àò·É¶)",
      "‡≤†o‡≤†",
      "‡≤∞_‡≤∞",
      "‚óî ‚å£ ‚óî",
      "(‚úø¬¥‚Äø`)",
      "ÿ®_ÿ®",
      "‚î¨‚îÄ‚î¨Ôªø Ô∏µ /(.‚ñ°. Ôºâ",
      "‚òº.‚òº",
      "^ÃÆ^",
      "(>‰∫∫<)",
      ">_>",
      "(/) (¬∞,,¬∞) (/)",
      "(ÔΩ•.‚ó§)",
      "=U",
      "~(Àò‚ñæÀò~)",
      "| (‚Ä¢ ‚ó°‚Ä¢)| (‚ùç·¥•‚ùç ã)"
    ];

    var output = emoji[Math.floor(Math.random() * emoji.length)];
    message.delete();
    message.channel.send(`**${output}!**`);
  }
});
